<!doctype html>
<html lang="en">
<head>
    <title>Spy</title>
    <script type="text/javascript" src="http://ajax.googleapis.com/ajax/libs/jquery/1.7.2/jquery.min.js"></script>
    <script type="text/javascript" src="http://ajax.aspnetcdn.com/ajax/jquery.templates/beta1/jquery.tmpl.min.js"></script>
    <script type="text/javascript" src="http://cdnjs.cloudflare.com/ajax/libs/underscore.js/1.3.3/underscore-min.js"></script>
    <script type="text/javascript" src="http://cdnjs.cloudflare.com/ajax/libs/backbone.js/0.9.2/backbone-min.js"></script>
    <!--    <script type="text/javascript" src="/js/jsonreport.js"></script>-->
</head>
<body>
    <div id="spyables">
    </div>
</body>
<script id="spyable-template" type="x-jquery-tmpl">
    <dl>
        <dt>Name</dt>
        <dd>${name}</dd>
    </dl>
</script>
<script type="text/javascript">
    var Spyable = Backbone.Model.extend({
        idAttribute: "name",
        url: "/spy/spyables"
    });

    var Spyables = Backbone.Collection.extend({
        model: Spyable,
        url: "/spy/spyables"
    });

    var SpyablesView = Backbone.View.extend({
        el: "#spyables",
        render: function () {
            var that = this;
            var spyables = new Spyables();
            spyables.fetch({
                success: function(spyables) {
                    $(that.el).html($.tmpl("", spyables));
                }
            });
        }
    });

    var view = new SpyablesView();
    view.render();
</script>
</html>